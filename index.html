<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Lein-cooper by kouphax</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Lein-cooper</h1>
        <p>Foreman style plugin for Leiningen for running long running dev tasks in parallel.</p>

        <p class="view"><a href="https://github.com/kouphax/lein-cooper">View the Project on GitHub <small>kouphax/lein-cooper</small></a></p>


        <ul>
          <li><a href="https://github.com/kouphax/lein-cooper/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/kouphax/lein-cooper/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/kouphax/lein-cooper">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="lein-cooper" class="anchor" href="#lein-cooper"><span class="octicon octicon-link"></span></a>lein-cooper</h1>

<blockquote>
<p><strong>cooper</strong> / co-op (per) / co-operative processes.</p>
</blockquote>

<p>A Leiningen plugin that can be used to combine multiple long runnning processes and pipe their output and error streams to <code>stdout</code> in a distinctive manner.</p>

<p>A <strong>long running process</strong> in this case is one that runs indefinitley and requires human interaction to stop.  Cooper will not play well with something that runs for a while and stops when it is done.  Thing server processes or file watchers and auto test runners.</p>

<p><code>lein-cooper</code> follows the standard set out by Rubys <a href="https://github.com/ddollar/foreman">Foreman</a> gem and processes are defined in a <code>Procfile</code> at the root of the project.  Each line is a process name and related command.  A sample Procfile looks like this,</p>

<pre><code>web: lein ring server
 jsx: jsx --watch src/ build/
</code></pre>

<p>This example defines 2 processes web and jsx.</p>

<ul>
<li>
<code>web</code> runs the ring server</li>
<li>
<code>jsx</code> runs the react.js precompiler in auto compile mode.</li>
</ul><p>This avoids having to manage checking on multiple windows and checking their output.</p>

<p>When processes spit out information to their <code>out</code> or <code>err</code> streams they are labelled and colour coded for easy distinction.</p>

<blockquote>
<p><strong>** CAUTION **</strong></p>

<p>The JVM is super pants at managing external processes which means that when a processes dies and cooper attempts to kill the other processes there may be some processes left running.  This is due to the fact that when the JVM kills processes it wont kill child process of that process.  There is also no cross paltform way to get a handle on child processes and kill them.</p>

<p>However this is only an issue when a process fails.  When you manually CTRL-C out of the lein cooper command everything will be shutdown as expected so this issue only happens in an error case.</p>
</blockquote>

<h2>
<a name="use-cases" class="anchor" href="#use-cases"><span class="octicon octicon-link"></span></a>Use Cases</h2>

<p>My need for this came about because I was tinkering with a Clojurescript project and needed to do 2 things.</p>

<ol>
<li>Run <a href="https://github.com/tailrecursion/lein-simpleton">lein-simpleton</a> to serve my static content</li>
<li>Run <a href="https://github.com/emezeske/lein-cljsbuild">lein-cljsbuild</a> in <code>auto</code> mode to compile my clojurescript on the fly.</li>
</ol><p>But any time you have more than one long running process (it needn't be a leiningen task of course, so any sort of web precompilers or auto test runners) then this will bring all the output into a nice single stream.</p>

<blockquote>
<p>This was created for a personal need and probably goes against typical Clojurarian workflows but everyone has their own flow.  Maybe this will help someone.</p>
</blockquote>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a name="user-level-plugins" class="anchor" href="#user-level-plugins"><span class="octicon octicon-link"></span></a>user-level plugins:</h3>

<p>Put <code>[lein-cooper "0.1.0"]</code> into the <code>:plugins</code> vector of your
<code>:user</code> profile.</p>

<h3>
<a name="project-level-plugins" class="anchor" href="#project-level-plugins"><span class="octicon octicon-link"></span></a>project-level plugins:</h3>

<p>Put <code>[lein-cooper "0.1.0-SNAPSHOT"]</code> into the <code>:plugins</code> vector of your project.clj.</p>

<h3>
<a name="create-procfile" class="anchor" href="#create-procfile"><span class="octicon octicon-link"></span></a>Create Procfile</h3>

<p>A procfile is a file containing lists of names processes,</p>

<pre><code>&lt;name&gt;:&lt;command to run&gt;
&lt;name&gt;:&lt;command to run&gt;
&lt;name&gt;:&lt;command to run&gt;
</code></pre>

<p>For example</p>

<pre><code>cljs:  lein cljsbuild auto
web: lein simpleton 8000
</code></pre>

<h3>
<a name="run" class="anchor" href="#run"><span class="octicon octicon-link"></span></a>Run</h3>

<p>Then just run <code>lein cooper</code></p>

<pre lang="shell"><code> $ lein cooper
</code></pre>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>Copyright Â© 2014 James Hughes</p>

<p>Distributed under the Eclipse Public License either version 1.0 or (at
your option) any later version.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/kouphax">kouphax</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-19143623-5");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>